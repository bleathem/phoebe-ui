#!/bin/bash

pushd ${HOME}

# restore build artifacts
if [ "$(ls /tmp/s2i/artifacts/ 2>/dev/null)" ]; then
    mv /tmp/s2i/artifacts/* ./
fi

# move the application source
mv /tmp/src/* ./

# build application artifacts
npm install -d
npm run build --prod

# Fix source directory permissions
fix-permissions ./

popd >/dev/null
